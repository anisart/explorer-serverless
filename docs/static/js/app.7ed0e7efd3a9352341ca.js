webpackJsonp([1],{0:function(t,e){},NHnr:function(t,e,o){"use strict";function a(t){o("mDtI")}function r(t,e){return Math.floor((t+180)/360*Math.pow(2,e))}function n(t,e){return Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,e))}function i(t,e){return t/Math.pow(2,e)*360-180}function l(t,e){var o=Math.PI-2*Math.PI*t/Math.pow(2,e);return 180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))}function s(t,e,o){return{north:l(e,o),south:l(e+1,o),west:i(t,o),east:i(t+1,o)}}function c(t){o("V7Jb")}Object.defineProperty(e,"__esModule",{value:!0});var u=o("/5sW"),p=o("3EgV"),d=o.n(p),v=(o("QCv7"),o("CgZs")),m=o.n(v),f={name:"app",data:function(){return{sideNav:!1,menuItems:[{title:"Upload track",icon:"file_upload",action:"uploadFile"},{title:"Explorer",icon:"widgets",action:"toggleExplorer"}]}},methods:{menuItemClicked:function(t){switch(this.sideNav=!1,t){case"uploadFile":this.$refs.fileInput.click();break;case"toggleExplorer":this.$refs.explorerZoom.dialog=!0}},filePicked:function(t){var e=this,o=t.target.files,a=new FileReader;a.addEventListener("load",function(){var t=(new DOMParser).parseFromString(a.result,"text/xml");e.$store.dispatch("setTrack",m.a.gpx(t))}),a.readAsText(o[0],"utf8")}}},h=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-app",{attrs:{light:""}},[o("v-navigation-drawer",{attrs:{fixed:""},model:{value:t.sideNav,callback:function(e){t.sideNav=e},expression:"sideNav"}},[o("v-list",t._l(t.menuItems,function(e){return o("v-list-tile",{key:e.title,on:{click:function(o){t.menuItemClicked(e.action)}}},[o("v-list-tile-action",[o("v-icon",[t._v(t._s(e.icon))])],1),t._v(" "),o("v-list-tile-content",[o("v-list-tile-title",[t._v(t._s(e.title))])],1)],1)}))],1),t._v(" "),o("v-toolbar",[o("v-toolbar-side-icon",{staticClass:"hidden-sm-and-up",attrs:{light:""},on:{click:function(e){e.stopPropagation(),t.sideNav=!t.sideNav}}}),t._v(" "),o("v-toolbar-title",[t._v("Explorer")]),t._v(" "),o("v-spacer"),t._v(" "),o("v-toolbar-items",{staticClass:"hidden-xs-only"},t._l(t.menuItems,function(e){return o("v-btn",{key:e.title,attrs:{flat:""},on:{click:function(o){t.menuItemClicked(e.action)}}},[o("v-icon",{attrs:{left:"",dark:""}},[t._v(t._s(e.icon))]),t._v("\n        "+t._s(e.title)+"\n      ")],1)}))],1),t._v(" "),o("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"text/xml text/gpx-xml text/gpx application/gpx-xml application/gpx"},on:{change:t.filePicked}}),t._v(" "),o("app-explorer-zoom",{ref:"explorerZoom",staticStyle:{display:"none"}}),t._v(" "),o("v-content",{attrs:{fluid:""}},[o("router-view")],1)],1)},x=[],g={render:h,staticRenderFns:x},k=g,y=o("VU/8"),_=a,b=y(f,k,!1,_,null,null),w=b.exports,M=o("/ocq"),I=o("BO1k"),E=o.n(I),Z=o("1e2d"),j=o.n(Z),F=o("+Div"),C=o.n(F),N={data:function(){return{map:null}},computed:{trackGeojson:function(){return this.$store.getters.track},explorerZoom:function(){return this.$store.state.explorerZoom}},watch:{trackGeojson:function(){this.map.getSource("track").setData(this.trackGeojson),this.fillExplorerLayer()},explorerZoom:function(){this.fillExplorerLayer()}},methods:{createMap:function(){j.a.accessToken="pk.eyJ1IjoiYW5pc2FydCIsImEiOiJjajluM3Z4YWgyNThjMzJtdmdlYTR4dG02In0.W1X35NjVBiwithy3SaUo8g",this.map=new j.a.Map({container:"map",style:"mapbox://styles/mapbox/streets-v9",center:[43.8052,56.2777],zoom:9,maxZoom:20,minZoom:1}),this.map.addControl(new j.a.NavigationControl),this.map.on("load",this.mapLoaded)},mapLoaded:function(){this.map.addSource("track",{type:"geojson",data:this.trackGeojson}),this.map.addLayer({id:"track",type:"line",source:"track",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#f00","line-width":2}}),this.map.addSource("explorer",{type:"geojson",data:null}),this.map.addLayer({id:"explorer",type:"fill",source:"explorer",paint:{"fill-color":"#0f0","fill-opacity":.3}})},fillExplorerLayer:function(){if(null!==this.trackGeojson){var t=[];this.trackGeojson.features.forEach(function(e){t=t.concat(e.geometry.coordinates)}),this.map.getSource("explorer").setData(this.getTiles(t,Number(this.explorerZoom)))}},getTiles:function(t,e){var o=[];t.forEach(function(t){var a=r(t[0],e),i=n(t[1],e);o.push({x:a,y:i})});var a={},i=[],l=!0,c=!1,u=void 0;try{for(var p,d=E()(o);!(l=(p=d.next()).done);l=!0){var v=p.value,m=v.x+"-"+v.y;if(!a[m]){a[m]=!0;var f=s(v.x,v.y,e),h={polygon:[[[f.west,f.north],[f.east,f.north],[f.east,f.south],[f.west,f.south],[f.west,f.north]]]};i.push(h)}}}catch(t){c=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw u}}return C.a.parse(i,{Polygon:"polygon"})}},mounted:function(){this.createMap()}},P=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{attrs:{id:"map"}})},S=[],T={render:P,staticRenderFns:S},V=T,$=o("VU/8"),L=c,D=$(N,V,!1,L,"data-v-5b0db2e4",null),G=D.exports;u.a.use(M.a);var O=new M.a({routes:[{path:"/",name:"Map",component:G}]}),J=o("NYxO");u.a.use(J.a);var z=new J.a.Store({state:{track:null,explorerZoom:"14"},mutations:{setTrack:function(t,e){t.track=e},setExplorerZoom:function(t,e){t.explorerZoom=e}},actions:{setTrack:function(t,e){(0,t.commit)("setTrack",e)},setExplorerZoom:function(t,e){(0,t.commit)("setExplorerZoom",e)}},getters:{track:function(t){return t.track},explorerZoom:function(t){return t.explorerZoom}}}),R={data:function(){return{dialog:!1}},computed:{dialogValue:{get:function(){return this.$store.state.explorerZoom},set:function(t){this.$store.commit("setExplorerZoom",t)}}}},U=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-layout",{attrs:{row:"","justify-center":""}},[o("v-dialog",{attrs:{scrollable:"","max-width":"300px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[o("v-btn",{attrs:{slot:"activator",color:"primary",dark:""},slot:"activator"},[t._v("Open Dialog")]),t._v(" "),o("v-card",[o("v-card-title",[t._v("Select explorer tile size")]),t._v(" "),o("v-divider"),t._v(" "),o("v-card-text",{staticStyle:{height:"300px"}},[o("v-radio-group",{attrs:{column:""},model:{value:t.dialogValue,callback:function(e){t.dialogValue=e},expression:"dialogValue"}},[o("v-radio",{attrs:{label:"4 km",value:"12"}}),t._v(" "),o("v-radio",{attrs:{label:"2 km",value:"13"}}),t._v(" "),o("v-radio",{attrs:{label:"1 km",value:"14"}}),t._v(" "),o("v-radio",{attrs:{label:"500 m",value:"15"}}),t._v(" "),o("v-radio",{attrs:{label:"250 m",value:"16"}})],1)],1),t._v(" "),o("v-divider"),t._v(" "),o("v-card-actions",[o("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Close")])],1)],1)],1)],1)},W=[],Y={render:U,staticRenderFns:W},B=Y,A=o("VU/8"),H=A(R,B,!1,null,null,null),Q=H.exports;u.a.component("app-explorer-zoom",Q),u.a.use(d.a,{theme:{primary:"#ee44aa",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}),u.a.config.productionTip=!1,new u.a({el:"#app",router:O,store:z,render:function(t){return t(w)}})},QCv7:function(t,e){},V7Jb:function(t,e){},mDtI:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.7ed0e7efd3a9352341ca.js.map